# Лабораторная работа №3: Аутентификация и авторизация в Node.js

## Цель работы
- Освоить методы аутентификации и авторизации в backend-приложениях на Node.js
- Реализовать защиту REST API с помощью JWT (JSON Web Token)
- Научиться разграничивать доступ к ресурсам в зависимости от роли пользователя

## Описание проекта

Данный проект представляет собой RESTful API сервис для управления пользователями и их питомцами с системой аутентификации и авторизации.

### Основные функции:
- Регистрация и аутентификация пользователей
- Управление данными пользователей
- Управление данными питомцев
- Разграничение прав доступа на основе ролей пользователей

## Структура проекта

```
├── controllers/
│   ├── petController.js      # Контроллер для управления питомцами
│   └── userController.js     # Контроллер для управления пользователями
├── helpers/
│   ├── createTable.js        # Скрипт создания таблиц в БД
│   └── db.js                 # Конфигурация подключения к БД
├── middleware/
│   └── authMiddleware.js     # Middleware для аутентификации
├── model/
│   ├── petModel.js          # Модель данных питомца
│   └── userModel.js         # Модель данных пользователя
├── routes/
│   ├── petRoute.js          # Маршруты для API питомцев
│   └── userRoute.js         # Маршруты для API пользователей
├── index.js                 # Основной файл приложения
└── package.json            # Зависимости проекта
```

## Стек технологий
- Node.js
- Express.js
- SQLite
- JWT для аутентификации
- bcrypt для хеширования паролей

## Установка и запуск проекта

### Предварительные требования
- Node.js (версия 14 или выше)
- npm (менеджер пакетов Node.js)
- SQLite (установленный )

### Шаги по установке

1. Клонируйте репозиторий:
```bash
git clone https://github.com/secretkota/laborator_SERVER_SIDE_NODEJS.git
cd laborator_nr3
```

2. Установите зависимости:
```bash
npm install
```

3. Создайте файл `.env` в корневой директории проекта со следующими параметрами:
```env
JWT_SECRET=your_jwt_secret
```
`Пример env находится в env copy`

4. Инициализируйте базу данных:
- База данных будет создана автоматически при первом запуске приложения
- Таблицы создаются с помощью скрипта `helpers/createTable.js`

### Запуск проекта

Для запуска в режиме разработки:
```bash
npm run dev
```

После запуска API будет доступен по адресу: `http://localhost:8000`

### Тестирование API

Вы можете использовать Postman или любой другой HTTP-клиент для тестирования API endpoints:

1. Регистрация нового пользователя:
```http
POST http://localhost:3000/api/auth/register
Content-Type: application/json

{
    "username": "testuser",
    "email": "test@example.com",
    "password": "password123"
}
```

2. Вход в систему:
```http
POST http://localhost:3000/api/auth/login
Content-Type: application/json

{
    "email": "test@example.com",
    "password": "password123"
}
```

## Ответы на контрольные вопросы

### 1. Что такое JWT и как он работает?

JWT (JSON Web Token) - это открытый стандарт для создания токенов доступа, который позволяет безопасно передавать информацию между сторонами в виде JSON-объекта. JWT состоит из трёх частей:
- Header (заголовок) - содержит тип токена и алгоритм шифрования
- Payload (полезная нагрузка) - содержит утверждения о пользователе
- Signature (подпись) - используется для проверки целостности токена

Процесс работы:
1. Пользователь аутентифицируется
2. Сервер создаёт JWT с необходимыми данными
3. Токен отправляется клиенту
4. Клиент использует токен в заголовке Authorization для последующих запросов
5. Сервер проверяет подпись токена и предоставляет доступ к ресурсам

### 2. Как реализовать безопасное хранение паролей пользователей?

Для безопасного хранения паролей используются следующие практики:
1. Хеширование паролей с использованием современных алгоритмов (например, bcrypt)
2. Использование "соли" (salt) для каждого пароля
3. Достаточное количество раундов хеширования
4. Никогда не хранить пароли в открытом виде
5. Использование надёжных криптографических библиотек

### 3. В чём разница между аутентификацией и авторизацией?

**Аутентификация:**
- Процесс проверки подлинности пользователя
- Отвечает на вопрос "Кто вы?"
- Происходит до авторизации
- Примеры: логин/пароль, биометрия, токены

**Авторизация:**
- Процесс проверки прав доступа аутентифицированного пользователя
- Отвечает на вопрос "Что вам разрешено делать?"
- Происходит после аутентификации
- Примеры: роли, разрешения, политики доступа

### 4. Какие преимущества и недостатки использования Passport.js для аутентификации в Node.js?

**Преимущества:**
- Большое количество готовых стратегий аутентификации
- Гибкая модульная архитектура
- Простота интеграции с Express.js
- Поддержка различных провайдеров OAuth
- Активное сообщество и хорошая документация

**Недостатки:**
- Дополнительная зависимость в проекте
- Может быть избыточным для простых случаев аутентификации
- Необходимость настройки каждой стратегии
- Некоторая сложность в понимании для начинающих
- Потенциальные проблемы с производительностью при использовании множества стратегий